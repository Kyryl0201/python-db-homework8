1) –°–æ–∑–¥–∞—Ç—å –∏ –æ–ø–∏—Å–∞—Ç—å Dockerfile

‚úÖ Dockerfile –µ—Å—Ç—å –∏ —Ä–∞–±–æ—á–∏–π (—Å—Ç–∞–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ–ø–∏—Ä—É–µ—Ç –ø—Ä–æ–µ–∫—Ç).
‚ö†Ô∏è –ï—Å–ª–∏ –≤ –∑–∞–¥–∞–Ω–∏–∏ –ø—Ä—è–º–æ —Ç—Ä–µ–±—É—é—Ç ‚Äú–æ–ø–∏—Å–∞—Ç—å‚Äù ‚Äî –Ω–∞–¥–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ README/–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (—á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞).

2) –°–æ–∑–¥–∞—Ç—å Celery Worker —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –Ω–∞ –≤—ã–±–æ—Ä (–∏–ª–∏ –æ–±–∞)
2.1 –ü–∏—Å—å–º–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ—á—Ç—ã

‚úÖ –ï—Å—Ç—å: –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è .delay(), –∏ –≤–æ—Ä–∫–µ—Ä —Ä–µ–∞–ª—å–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç/–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á—É ‚Äî —É —Ç–µ–±—è —ç—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –ª–æ–≥–∞–º–∏ (Task received, DEBUG EMAIL, succeeded).

2.2 –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞ —Ä–∞–∑ –≤ –¥–µ–Ω—å ‚Äú–Ω–æ–≤—ã–µ —Ñ–∏–ª—å–º—ã –∑–∞ 24 —á–∞—Å–∞‚Äù

‚úÖ –ü–æ –∫–æ–¥—É —Ç—ã —ç—Ç–æ –¥–æ–±–∞–≤–∏–ª (–∑–∞–¥–∞—á–∞ send_daily_new_films —É –≤–æ—Ä–∫–µ—Ä–∞ –≤–∏–¥–Ω–∞ –≤ —Å–ø–∏—Å–∫–µ tasks).
‚ö†Ô∏è –ù–æ –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É —Ç–µ–±—è –∑–∞–ø—É—â–µ–Ω celery beat (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å) –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç.

–ï—Å–ª–∏ —É —Ç–µ–±—è –≤ docker compose ps –µ—Å—Ç—å celery_beat –∏ –æ–Ω ‚ÄúUp‚Äù ‚Äî —Ç–æ–≥–¥–∞ ‚úÖ –ø–æ–ª–Ω–æ—Å—Ç—å—é.

–ï—Å–ª–∏ beat –Ω–µ—Ç ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å –∑–∞–¥–∞—á—É —Ä—É–∫–∞–º–∏.

3) –°–æ–∑–¥–∞—Ç—å –∏ –æ–ø–∏—Å–∞—Ç—å docker-compose.yml (–≤ —Ç–æ–º —á–∏—Å–ª–µ RabbitMQ)

‚úÖ –ï—Å—Ç—å docker-compose.yml, –ø–æ–¥–Ω–∏–º–∞–µ—Ç RabbitMQ + Postgres + webapp + celery_worker (–∏ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ celery_beat).
‚úÖ RabbitMQ management UI —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç—ã –∑–∞—Ö–æ–¥–∏–ª (admin/admin).
‚ö†Ô∏è –ï—Å–ª–∏ —Ç—Ä–µ–±—É—é—Ç ‚Äú–æ–ø–∏—Å–∞—Ç—å‚Äù ‚Äî –æ–ø—è—Ç—å –∂–µ –Ω–∞–¥–æ –ø–∞—Ä—É —Å—Ç—Ä–æ–∫ –≤ README.

4) –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

‚úÖ –¢—ã —ç—Ç–æ —Å–¥–µ–ª–∞–ª –∏ –¥–æ–∫–∞–∑–∞–ª:

webapp –æ—Ç–¥–∞—ë—Ç /register –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç OK

Celery –≤–æ—Ä–∫–µ—Ä connected –∫ broker

–∑–∞–¥–∞—á–∞ —Ä–µ–∞–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è (received ‚Üí succeeded)

RabbitMQ UI –¥–æ—Å—Ç—É–ø–µ–Ω

–ò—Ç–æ–≥ —á–µ—Å—Ç–Ω–æ

‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –∑–∞–¥–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ –Ω–∞ 100%, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º —á–µ—Ä–µ–∑ Celery+RabbitMQ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω.

–ß—Ç–æ–±—ã –≤–æ–æ–±—â–µ –Ω–µ –ø—Ä–∏–¥—Ä–∞–ª–∏—Å—å, —è –±—ã –¥–æ–±–∞–≤–∏–ª 2 –≤–µ—â–∏:

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –µ—Å—Ç—å celery_beat –≤ docker-compose –∏ –æ–Ω –∑–∞–ø—É—â–µ–Ω (–µ—Å–ª–∏ —Ç—ã –∑–∞—è–≤–ª—è–µ—à—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É).

–°–¥–µ–ª–∞—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–π README.md —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º Dockerfile/compose –∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ –∑–∞–ø—É—Å–∫–∞/–ø—Ä–æ–≤–µ—Ä–∫–∏.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî —è –ø—Ä—è–º–æ —Ç—É—Ç –Ω–∞–ø–∏—à—É —Ç–µ–±–µ –≥–æ—Ç–æ–≤—ã–π README.md –Ω–∞ 15‚Äì25 —Å—Ç—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ —ç—Ç–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.

–¥–∞

–û—Ç–ª–∏—á–Ω–æ üëç
–í–æ—Ç –≥–æ—Ç–æ–≤—ã–π README.md, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ 100% –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è.
–¢—ã –º–æ–∂–µ—à—å –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –≤ —Ñ–∞–π–ª README.md –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.

üìß Email Notification Service (Flask + Celery + RabbitMQ)
üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Celery –∏ RabbitMQ.
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é Docker –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ docker-compose.

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:

–æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;

–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –ø–∏—Å–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–æ–≤—ã–µ —Ñ–∏–ª—å–º—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞).

üê≥ Dockerfile

Dockerfile –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

–±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑: python:3-slim;

—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏–∑ requirements.txt;

–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä;

–∑–∞–ø—É—Å–∫ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

‚öôÔ∏è Celery Worker

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Celery worker, –∫–æ—Ç–æ—Ä—ã–π:

–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–¥–∞—á–∏ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ RabbitMQ;

–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è;

–≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (—á–µ—Ä–µ–∑ celery beat).

–ü—Ä–∏–º–µ—Ä—ã –∑–∞–¥–∞—á:

send_html_email ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email;

send_daily_new_films ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –Ω–æ–≤—ã—Ö —Ñ–∏–ª—å–º–æ–≤.

üêá RabbitMQ

RabbitMQ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ broker —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è Celery.

–î–æ—Å—Ç—É–ø–µ–Ω web-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å RabbitMQ Management:

http://localhost:15672
login: admin
password: admin

üß© docker-compose.yml

–§–∞–π–ª docker-compose.yml –ø–æ–¥–Ω–∏–º–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã:

webapp ‚Äî Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ;

celery_worker ‚Äî Celery worker;

celery_beat ‚Äî –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á;

rabbitmq ‚Äî –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π;

database ‚Äî PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–í –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

docker compose up --build

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:

http://localhost:5000/register


–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–í –ª–æ–≥–∞—Ö celery_worker –ø–æ—è–≤–∏—Ç—Å—è:

–ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ (Task received);

–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ (succeeded);

—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∏—Å—å–º–∞ (–≤ DEBUG-—Ä–µ–∂–∏–º–µ).

–í RabbitMQ Management UI –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –æ—á–µ—Ä–µ–¥—å celery.

üèÅ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ email —Ä–∞–±–æ—Ç–∞–µ—Ç;

Celery —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ RabbitMQ;

–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è;

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Docker